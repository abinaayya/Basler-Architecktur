<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Karte – BAULINIE Basel</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

<header class="nav">
  <div class="nav-inner">
    <div class="logo">BAULINIE Basel</div>

    <nav class="nav-links">
      <a href="index.html" class="nav-link">Home</a>
      <a href="zeitstrahl.html" class="nav-link">Zeitstrahl</a>
      <a href="karte.html" class="nav-link nav-link--active">Karte</a>

      <div class="dropdown">
        <button class="dropbtn" type="button">Bauwerke ▾</button>
        <div class="dropdown-content">
          <a href="elisabethen.html">1864 · Elisabethenkirche</a>
          <a href="markthalle.html">1929 · Markthalle</a>
          <a href="messe.html">2013 · Messe</a>
          <a href="kunstmuseum.html">2016 · Kunstmuseum</a>
          <a href="weinlager.html">2023 · Weinlager</a>
          <a href="novartis.html">2022 · Novartis Campus</a>
        </div>
      </div>
    </nav>
  </div>
</header>

<main class="map-page">
  <section class="map-hero">
    <div class="map-hero-inner">
      <h1>Karte</h1>
      <p>Zoomen & ziehen: Maus/Touch. Auf dem Handy: Pinch-Zoom.</p>
    </div>
  </section>

  <section class="map-shell">
    <div class="map-toolbar">
      <button class="toolbtn" type="button" id="zoomIn">＋</button>
      <button class="toolbtn" type="button" id="zoomOut">－</button>
      <button class="toolbtn" type="button" id="reset">Reset</button>

      <!-- optional: PDF Download -->
      <!-- <a class="toolbtn toolbtn-link" href="karte.pdf" download>PDF</a> -->
    </div>

    <div class="map-frame" id="mapFrame" aria-label="Kartenviewer">
      <img id="mapImage" src="Karte_Basel.jpg" alt="Karte Basel – Tramlinien und Bauwerke" draggable="false">
    </div>

    <p class="map-hint">
     Doppelklick (Desktop) oder Doppeltippen (Mobile) zoomt.
    </p>
  </section>
</main>

<!-- kleine Zoom/Pan Library (sehr leichtgewichtig) -->
<script src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>
<script>
  const frame = document.getElementById("mapFrame");
  const img = document.getElementById("mapImage");

const panzoom = Panzoom(img, {
  maxScale: 8,
  minScale: 0.1,
  contain: 'outside',
  cursor: 'grab',
  animate: true
});
function fitMap() {
  const frameRect = frame.getBoundingClientRect();
  const iw = img.naturalWidth;
  const ih = img.naturalHeight;
  if (!iw || !ih) return;

  const scale = Math.min(frameRect.width / iw, frameRect.height / ih);

  panzoom.reset({ animate: false });
  panzoom.zoom(scale, { animate: false });

  // Zentrieren:
  const x = (frameRect.width - iw * scale) / 2;
  const y = (frameRect.height - ih * scale) / 2;
  panzoom.pan(x, y, { animate: false });
}

img.addEventListener("load", fitMap);
window.addEventListener("resize", fitMap);
// Wichtig: Touch-Pinch aktivieren
frame.addEventListener('pointerdown', (e) => {
  // verhindert, dass der Browser beim Drag "scrollt"
  if (e.pointerType === 'touch') e.preventDefault();
});
  // Zoom mit Mausrad
frame.addEventListener('wheel', panzoom.zoomWithWheel, { passive: false });

  // Buttons
  document.getElementById("zoomIn").addEventListener("click", () => panzoom.zoomIn());
  document.getElementById("zoomOut").addEventListener("click", () => panzoom.zoomOut());
 document.getElementById("reset").addEventListener("click", () => fitMap());

  // Doppelklick / Doppeltipp zum Zoomen
  let lastTap = 0;
  frame.addEventListener("dblclick", (e) => {
    e.preventDefault();
    panzoom.zoomIn({ animate: true });
  });

  frame.addEventListener("touchend", (e) => {
    const now = Date.now();
    if (now - lastTap < 300) panzoom.zoomIn({ animate: true });
    lastTap = now;
  }, { passive: true });
</script>

</body>
</html>